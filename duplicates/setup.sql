--create table PEDIDOS
CREATE TABLE PEDIDOS (
  ID_PEDIDO     NUMBER GENERATED BY DEFAULT AS IDENTITY,
  ID_CLIENTE    NUMBER NOT NULL,
  PRODUCTO      VARCHAR2(100) NOT NULL,
  FECHA_COMPRA  DATE DEFAULT SYSDATE,
  CONSTRAINT PK_PEDIDOS PRIMARY KEY (ID_PEDIDO)
);

--create audit table
CREATE TABLE AUDIT_DUP_PEDIDOS AS
SELECT * FROM PEDIDOS WHERE 1=0;

--Insert mock data
INSERT INTO PEDIDOS (ID_CLIENTE, PRODUCTO, FECHA_COMPRA) VALUES (1, ‘Teclado’,  DATE ‘2023-01-01’);
INSERT INTO PEDIDOS (ID_CLIENTE, PRODUCTO, FECHA_COMPRA) VALUES (1, ‘Teclado’,  DATE ‘2023-01-05’); -- duplicado
INSERT INTO PEDIDOS (ID_CLIENTE, PRODUCTO, FECHA_COMPRA) VALUES (1, ‘Ratón’,    DATE ‘2023-02-01’);
INSERT INTO PEDIDOS (ID_CLIENTE, PRODUCTO, FECHA_COMPRA) VALUES (2, ‘Pantalla’, DATE ‘2023-03-15’);
INSERT INTO PEDIDOS (ID_CLIENTE, PRODUCTO, FECHA_COMPRA) VALUES (2, ‘Pantalla’, DATE ‘2023-03-16’); -- duplicado
INSERT INTO PEDIDOS (ID_CLIENTE, PRODUCTO, FECHA_COMPRA) VALUES (3, ‘Altavoz’,  DATE ‘2023-04-10’);

COMMIT;
